;/*FB_PKG_DELIM*/

__d("LSThreadCentricThreadsRangesQuery",["LSIssueNewTaskWithExtraOperations"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("parent_thread_key",a[0]),d[0].set("filter",a[1]),d[0].set("reference_thread_key",a[2]),d[0].set("reference_activity_timestamp",a[3]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"tc_trq",c.i64.cast([0,727]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))},function(b){return d[4]=a[3]==null?c.i64.cast([0,1]):a[3],d[3]=a[2]==null?c.i64.cast([-2147483648,0]):a[2],d[5]=c.i64.gt(d[4],c.i64.cast([0,1]))&&c.i64.gt(d[3],c.i64.cast([-2147483648,0])),c.filter(c.db.table(247).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.parentThreadKey,a[0])&&c.i64.eq(b.threadRangeFilter,a[1])}).next().then(function(b,e){e=b.done;b=b.value;return e?c.db.table(247).add({folderName:"inbox",parentThreadKey:a[0],minThreadKey:d[3],minLastActivityTimestampMs:d[4],threadRangeFilter:a[1],secondaryThreadRangeFilter:c.i64.cast([0,0]),threadRangeFilterValue:"",maxLastActivityTimestampMs:c.i64.cast([0,1]),maxThreadKey:c.i64.cast([-2147483648,0]),isLoadingBefore:d[5],isLoadingAfter:!1,hasMoreBefore:d[5],hasMoreAfter:!1}):(b.item,c.forEach(c.filter(c.db.table(247).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.parentThreadKey,a[0])&&c.i64.eq(b.threadRangeFilter,a[1])}),function(a){var b=a.update;a.item;return b({isLoadingBefore:!0,isLoadingAfter:!1,hasMoreBefore:d[5],hasMoreAfter:!1})}))})}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSVerifyCommunityListSynced",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.createArray(),d[1]=c.createArray(),c.forEach(c.db.table(162).fetch(),function(a){a=a.item;return d[6]=(d[0].push(a.folderId),d[0])})},function(a){return d[2]=c.i64.of_float(Date.now()),d[3]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(162).fetch(),function(a){return c.i64.lt(c.i64.eq(a.readTimestampMs==null?c.i64.cast([0,0]):a.readTimestampMs,c.i64.cast([0,0]))?d[2]:a.readTimestampMs==null?c.i64.cast([0,0]):a.readTimestampMs,c.i64.sub(d[3],c.i64.cast([0,432e5])))}),function(a){a=a.item;return d[6]=(d[1].push(a.folderId),d[1])})},function(a){return d[4]=new c.Map(),d[4].set("existed_community_ids",d[0]),d[4].set("expired_community_ids",d[1]),d[4].set("skip_community_presence_sync",!1),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"verify_community_list_synced",c.i64.cast([0,425]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);